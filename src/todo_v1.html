<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToDo v1</title>
</head>
<body>

    <div>
        <h1>todo</h1>

        <div id="todolist"></div>

        <form class="add-todo-form" id="todoForm">
            <input type="text" name="todo_content" id="todoInput">
            <input type="submit" value="Add" id="todoSubmmit">
        </form>

    </div>
    <script>
        const newTodo = document.getElementById('todoInput');
        const addTodo = document.getElementById('todoSubmmit');
        const todoForm = document.getElementById('todoForm');
        const todolist = document.getElementById('todolist');

        let todos = loadTodos();

        function loadTodos() {
            const data = localStorage.getItem('todos');
            return data ? JSON.parse(data) : [];
        }

        function storeTodos() {
            localStorage.setItem('todos', JSON.stringify(todos));
        }

        function toggleTodo(index) {
            todos[index].done = !todos[index].done;
            storeTodos();
            renderTodos();
        }
        function toggleTodo(index) {
            todos[index].done = !todos[index].done;

            localStorage.setItem('todos', todos);
        };

        function renderTodos() {
            let html = '';
            todos.forEach((todo, index) => {
                html += `
                    <div>
                        <input type="checkbox" ${todo.done ? 'checked' : ''} onchange="toggleTodo(${index})">
                        <span class="todo ${todo.done ? 'done' : ''}">${todo.content}</span>
                    </div>
                `;
            });
            todolist.innerHTML = html;
        }

        function createTodo(e) {
            e.preventDefault();

            const content = todoInput.value.trim();

            if(!content) {
                return;
            }

            todos.push({
                content: content,
                done: false,
            });
            
            localStorage.setItem('todos', todos);

            todoInput.value = '';
            storeTodos();
            renderTodos();
        }

        //addTodo.addEventListener('click');
        todoForm.addEventListener('submit', createTodo);
        renderTodos();
    </script>
</body>
</html>